/* === ✨ 全新 土黃色系 (Ochre) 色調 ✨ === */
:root {
  --brand: #9a6700;      /* 品牌色：溫暖的深棕色 */
  --brand-light: rgba(154, 103, 0, 0.1); /* 淡褐色 */
  --danger: #ef4444;      /* 紅色 */
  
  /* 這裡已調整為你要的背景色 */
  --bg: #D6C88E;          /* 整頁背景：糯米橋主色 */
  --card: #fffcf5;        /* ✨ 卡片與側邊欄背景：溫暖的奶油黃 ✨ */
  --border: #f0e9d9;      /* 邊框：略深的米色 */
  
  --card-selected: #fff4d4; /* 卡片選中時的實心土黃色 */
  
  --text: #44403c;        /* 文字：深石板灰色 */
  --muted: #78716c;       /* 輔助文字：中性石板灰 */
  
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;

  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
}

* { box-sizing: border-box; }
html, body { height: 100%; overflow: hidden; }

body {
  margin: 0;
  font-family: "Noto Sans TC", system-ui, -apple-system, Segoe UI, Roboto,
    "Helvetica Neue", Arial, "PingFang TC", "Microsoft JhengHei", sans-serif;
  color: var(--text);
  background: var(--bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* === 核心佈局調整 === */
.container { height: 100vh; padding: 0; display: flex; flex-direction: column; }
h1 { margin: 0; padding: 16px 24px; font-size: 24px; position: relative; z-index: 30; background: rgba(253, 250, 242, 0.7); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); border-bottom: 1px solid var(--border); flex-shrink: 0; }
.content { position: relative; flex-grow: 1; }
#map { position: absolute; inset: 0; width: 100%; height: 100%; z-index: 1; }

/* === 頂部圖卡列 (水平滑動效果) === */
.top-strip {
  position: absolute; top: 12px;
  left: calc(360px + 20px + 20px); right: 20px;
  z-index: 10; padding: 20px 0;
  overflow-x: auto; white-space: nowrap; cursor: grab; user-select: none;
  scrollbar-width: none; -ms-overflow-style: none;
  scroll-behavior: smooth;
}
.top-strip::-webkit-scrollbar { display: none; }
.top-strip.active { cursor: grabbing; cursor: -webkit-grabbing; }
.top-strip .box { padding: 0; margin: 0; border: none; background: transparent; box-shadow: none; }

#checkbox-list {
  display: flex; flex-wrap: nowrap; gap: 16px;
  padding: 0 20px;
}

/* === 圖卡選項 (水平滑動效果) === */
.option-card {
  display: inline-flex; flex-direction: column; width: 180px; flex-shrink: 0; white-space: normal; padding: 16px;
  border: 1px solid var(--border); border-radius: var(--radius-lg); cursor: pointer; user-select: none;
  background-color: var(--card); box-shadow: var(--shadow-md);
  transition: transform 0.2s ease, box-shadow 0.2s, background-color 0.2s, border-color 0.2s;
}
.option-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.option-card .name { font-weight: 600; margin-bottom: 4px; font-size: 15px;}
.option-card .details { font-size: 13px; color: var(--muted); }
.option-card:has(input:checked) {
  border-color: var(--brand);
  background: var(--card-selected); /* ✨ 修正點 ✨ */
  box-shadow: 0 0 0 3px var(--brand-light);
}

/* === 左側側邊欄 === */
.sidebar {
  position: absolute; top: 20px; left: 20px; z-index: 20; width: 360px;
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius-lg);
  padding: 8px 8px 16px 8px; box-shadow: var(--shadow-lg); max-height: calc(100% - 40px); overflow-y: auto;
}
.sidebar h2 { font-size: 20px; font-weight: 700; padding: 12px 16px 8px; margin: 0; color: var(--brand); }
.sidebar h3 { font-size: 16px; font-weight: 600; padding: 4px 16px 8px; margin: 12px 0 0 0; border-top: 1px solid var(--border); }
.sidebar .box { border: none; box-shadow: none; padding: 0px 16px; margin-bottom: 0; }
.sidebar .selected.box { background-color: var(--bg); padding: 0 16px 16px; margin-top: 4px; border-radius: var(--radius-md); }
.sidebar .selected h2 { padding-left: 0; }

/* === 表單 & 按鈕 (全域) === */
label { display: block; margin-bottom: 6px; font-size: 14px; font-weight: 500; }
.filters label { display: inline-block; margin-bottom: 8px; font-weight: 400; }
button, select, input {
  width: 100%; padding: 10px 12px; font-size: 14px; border: 1px solid var(--border);
  border-radius: var(--radius-sm); background: var(--card); transition: all .2s; margin-bottom: 10px;
}
input[type="checkbox"]{ width: auto; margin-right: 6px; border-radius: 4px; }
button:focus-visible, select:focus-visible, input:focus-visible { outline: none; border-color: var(--brand); box-shadow: 0 0 0 3px var(--brand-light); }
button {
  cursor: pointer; border: none; background: var(--brand); color: #fff;
  font-weight: 600; margin-bottom: 0; border-radius: var(--radius-sm);
}
button:hover { filter: brightness(1.1); transform: translateY(-1px); box-shadow: var(--shadow-md); }
button:active { transform: scale(0.98) translateY(0); }
.btn-ghost { background: var(--card); color: var(--text); border: 1px solid var(--border); }
.btn-danger { background: var(--danger); color: #fff; }
.button-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 8px; margin-top: 8px; }
.button-row button { margin-bottom: 0; }
.filter-actions { display: flex; gap: 8px; margin-top: 8px; }
.filter-actions button { flex: 1 1 0; }

/* === 已選行程 === */
.selected { margin-top: 12px; }
.sortable-list { list-style: decimal inside; padding: 8px; margin: 10px 0; border: none; border-radius: 8px; background: var(--bg); }
.sortable-list li {
  display: flex; align-items: center; gap: 8px; padding: 12px;
  border-radius: var(--radius-md); box-shadow: var(--shadow-sm); transition: box-shadow .2s; background: var(--card); border: 1px solid var(--border);
}
.sortable-list li:hover { box-shadow: var(--shadow-md); }
.sortable-list .name { flex: 1 1 auto; min-width: 0; font-weight: 500; margin-right: auto; }
.sortable-list .staywrap { display: flex; align-items: center; gap: 6px; flex-shrink: 0; }
.sortable-list .staywrap label { width: auto; margin-bottom: 0; }
.sortable-list input.stay { width: 60px; margin-bottom: 0; text-align: center; }
.sortable-list .remove { width: auto; padding: 8px 12px; flex-shrink: 0; background-color: #fee2e2; color: var(--danger);}
.sortable-list .remove:hover { background-color: var(--danger); color: #fff; }
.selected-actions { display: flex; gap: 8px; }
.selected-actions button { flex: 1 1 0; }
#selected-list li.flash { box-shadow: 0 0 0 3px var(--brand-light); transition: box-shadow .9s; }
#selected-list li.flash.fade { box-shadow: none; }

/* === 行程明細表 === */
#itinerary { margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border); font-size: 14px; line-height: 1.6; }
#itinerary table { width: 100%; border-collapse: collapse; margin-top: 8px; }
#itinerary th, #itinerary td { border-bottom: 1px solid var(--border); padding: 8px 4px; text-align: left; font-size: 13px; }
#itinerary th { font-weight: 600; color: var(--muted); }

/* === Emoji 標記 & Toast === */
.emoji-marker { display: inline-grid; place-items: center; width: 32px; height: 32px; border-radius: 50%; background: rgba(255, 255, 255, .95); font-size: 20px; border: 1px solid #ddd; box-shadow: var(--shadow-md); user-select: none; font-family: "Noto Color Emoji", "Apple Color Emoji", "Segoe UI Emoji", "Noto Sans TC", system-ui, sans-serif; transition: transform .2s ease, box-shadow .2s ease; }
.emoji-marker.selected { border-color: var(--brand); box-shadow: 0 0 0 3px #fff, 0 0 0 5px var(--brand); }
@keyframes pulseRing { 0% { box-shadow: 0 0 0 3px #fff, 0 0 0 5px var(--brand), 0 0 0 5px rgba(154,103,0,0.4); } 70% { box-shadow: 0 0 0 3px #fff, 0 0 0 5px var(--brand), 0 0 0 15px rgba(154,103,0,0); } 100% { box-shadow: 0 0 0 3px #fff, 0 0 0 5px var(--brand), 0 0 0 5px rgba(154,103,0,0); } }
.emoji-marker.selected { animation: pulseRing 1.5s infinite; }
.emoji-marker.clicked { animation: bounceIn .35s ease-out; }
@keyframes bounceIn { 0% { transform: translateY(-6px) scale(1.2); } 60% { transform: translateY(0) scale(1.0); } 100% { transform: translateY(0) scale(1.0); } }
#checkbox-list .option-card.highlight { background: #fffde7; transition: background .6s; }
#checkbox-list .option-card.highlight.fade { background: transparent; }
.toast { position: fixed; left: 50%; bottom: 24px; transform: translateX(-50%) translateY(20px); background: rgba(33, 33, 33, .95); color: #fff; padding: 12px 18px; border-radius: var(--radius-md); font-size: 14px; opacity: 0; pointer-events: none; transition: opacity .2s, transform .2s; z-index: 1000; box-shadow: var(--shadow-lg); }
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

/* === 手機版浮動按鈕 & 遮罩 === */
.fab { display: none; }
.backdrop { display: none; }
.sidebar { will-change: transform; -webkit-overflow-scrolling: touch; }

/* ===== RWD 手機優化 (≤ 768px) ====== */
@media (max-width: 768px) {
  h1 { padding: 12px 16px; font-size: 20px; }
  .top-strip { 
    left: 16px;
    right: 16px;
    top: 0;
  }
  #checkbox-list { gap: 12px; }
  .top-strip .option-card { width: 150px; }
  
  .sidebar { 
    position: fixed; top: 0; left: 0; width: 88vw; max-width: 360px; 
    height: 100vh; max-height: 100vh; border-radius: 0; border: none; 
    transform: translateX(-100%); 
    transition: transform .3s cubic-bezier(0.4, 0, 0.2, 1); 
    z-index: 40; 
  }
  .sidebar.open { transform: translateX(0); }
  
  .backdrop { 
    display: block; position: fixed; inset: 0; background: rgba(0, 0, 0, .4); 
    z-index: 35; opacity: 0; visibility: hidden; pointer-events: none; 
    transition: opacity .25s ease, visibility .25s ease; 
  }
  .backdrop.show { opacity: 1; visibility: visible; pointer-events: auto; }
  
  .fab { 
    position: fixed; right: 20px; bottom: 20px; z-index: 38; 
    display: inline-flex; align-items: center; justify-content: center; 
    width: 56px; height: 56px; border-radius: 50%; 
    background: var(--brand); color: #fff; font-weight: 700; font-size: 16px; 
    border: none; box-shadow: var(--shadow-lg); transition: transform .2s; 
  }
  .fab:active{ transform: scale(0.95); }
  
  button, select, input { min-height: 48px; font-size: 16px; padding: 12px; }
  input[type="checkbox"]{ min-height: auto; }
}
